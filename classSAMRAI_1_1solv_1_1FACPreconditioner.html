<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>SAMRAI: SAMRAI::solv::FACPreconditioner Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li id="current"><a href="annotated.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
    <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="namespaceSAMRAI.html">SAMRAI</a>::<a class="el" href="namespaceSAMRAI_1_1solv.html">solv</a>::<a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html">FACPreconditioner</a></div>
<h1>SAMRAI::solv::FACPreconditioner Class Reference</h1><!-- doxytag: class="SAMRAI::solv::FACPreconditioner" -->Implements the FAC iterative solution procedure for a linear system of equations, Au=f, defined on some subset of levels in an AMR patch hierarchy.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;source/SAMRAI/solv/FACPreconditioner.h&gt;</code>
<p>
<a href="classSAMRAI_1_1solv_1_1FACPreconditioner-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#2e9c467686dbdb2e6d7aeed69b73aebe">FACPreconditioner</a> (const std::string &amp;name, <a class="el" href="classSAMRAI_1_1solv_1_1FACOperatorStrategy.html">FACOperatorStrategy</a> &amp;user_ops, const boost::shared_ptr&lt; <a class="el" href="classSAMRAI_1_1tbox_1_1Database.html">tbox::Database</a> &gt; &amp;database=boost::shared_ptr&lt; <a class="el" href="classSAMRAI_1_1tbox_1_1Database.html">tbox::Database</a> &gt;())</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#bf1bf0cc1ece3ad7ceacda43fd48e4c4">~FACPreconditioner</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#c3109814e040e2133204a26d31ec2f0b">solveSystem</a> (<a class="el" href="classSAMRAI_1_1solv_1_1SAMRAIVectorReal.html">SAMRAIVectorReal</a>&lt; double &gt; &amp;solution, <a class="el" href="classSAMRAI_1_1solv_1_1SAMRAIVectorReal.html">SAMRAIVectorReal</a>&lt; double &gt; &amp;rhs)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Solve linear system Au=f using the FAC algorithm.  <a href="#c3109814e040e2133204a26d31ec2f0b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#224f2e5736891837a0a6f173ef2d5100">initializeSolverState</a> (const <a class="el" href="classSAMRAI_1_1solv_1_1SAMRAIVectorReal.html">SAMRAIVectorReal</a>&lt; double &gt; &amp;solution, const <a class="el" href="classSAMRAI_1_1solv_1_1SAMRAIVectorReal.html">SAMRAIVectorReal</a>&lt; double &gt; &amp;rhs)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute hierarchy-dependent data required for solving.  <a href="#224f2e5736891837a0a6f173ef2d5100"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#bf34a53392b560ef4450278071c2e5ef">deallocateSolverState</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Remove all hierarchy-dependent data computed by <a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#224f2e5736891837a0a6f173ef2d5100">initializeSolverState()</a>.  <a href="#bf34a53392b560ef4450278071c2e5ef"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#c93151dec50bdf46302096909c86ac8f">checkVectorStateCompatibility</a> (const <a class="el" href="classSAMRAI_1_1solv_1_1SAMRAIVectorReal.html">SAMRAIVectorReal</a>&lt; double &gt; &amp;solution, const <a class="el" href="classSAMRAI_1_1solv_1_1SAMRAIVectorReal.html">SAMRAIVectorReal</a>&lt; double &gt; &amp;rhs) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check compatibility of vectors with existing solver state.  <a href="#c93151dec50bdf46302096909c86ac8f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#742507f38d5d6f62cd41aa185123f248">printClassData</a> (std::ostream &amp;os) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Print data members for debugging.  <a href="#742507f38d5d6f62cd41aa185123f248"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const std::string &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#66f2514781a4e19a2722bc454b9aecd3">getObjectName</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the name of this object.  <a href="#66f2514781a4e19a2722bc454b9aecd3"></a><br></td></tr>
<tr><td colspan="2"><div class="groupHeader">Functions to set solving parameters.</div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#106b064c71994802f3a5cdc3ccc4afc7">setPresmoothingSweeps</a> (int num_pre_sweeps)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the number of pre-smoothing sweeps during FAC iteration process.  <a href="#106b064c71994802f3a5cdc3ccc4afc7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#56931d46e0b47521deeac16bd94d8f2c">setPostsmoothingSweeps</a> (int num_post_sweeps)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the number of post-smoothing sweeps during FAC iteration process.  <a href="#56931d46e0b47521deeac16bd94d8f2c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#fe186c64f642b4250e38cf525d7e4ffa">setMaxCycles</a> (int max_cycles)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the max number of iterations (cycles) to use per solve.  <a href="#fe186c64f642b4250e38cf525d7e4ffa"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#bc8ee965b915317f32f1c623441814e4">setResidualTolerance</a> (double residual_tol, double relative_residual_tol=-1.0)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the residual tolerance for stopping.  <a href="#bc8ee965b915317f32f1c623441814e4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#a08148017b68708b80720938132685f9">setAlgorithmChoice</a> (const std::string &amp;choice)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the choice of FAC cycling algorithm to use.  <a href="#a08148017b68708b80720938132685f9"></a><br></td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#4c89ecf5208e7b610667034fcc52161d">enableLogging</a> (bool enabled=true)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Enable or disable logging.  <a href="#4c89ecf5208e7b610667034fcc52161d"></a><br></td></tr>
<tr><td colspan="2"><div class="groupHeader">Functions to get data on last solve.</div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#afebbb6567c56eaf44bbbbfccdcaa69d">getNumberOfIterations</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return FAC iteration count from last (or current if there is one) FAC iteration process.  <a href="#afebbb6567c56eaf44bbbbfccdcaa69d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#920b3306fa08ad13648e4b489d8b375f">getConvergenceFactors</a> (double &amp;avg_factor, double &amp;final_factor) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get convergance rates of the last (or current if there is one) FAC solve.  <a href="#920b3306fa08ad13648e4b489d8b375f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#237802e2e0047b4a946bd218a1525875">getNetConvergenceFactor</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the net convergance rate of the last (or current if there is one) FAC solve.  <a href="#237802e2e0047b4a946bd218a1525875"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#38798adf3e0362d69ec57a7f8c2ef908">getAvgConvergenceFactor</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the average convergance rates of the last (or current if there is one) FAC solve.  <a href="#38798adf3e0362d69ec57a7f8c2ef908"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#ab425776ab17c5a75fa61b0f446dedea">getFinalConvergenceFactor</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the final convergance rate of the last (or current if there is one) FAC solve.  <a href="#ab425776ab17c5a75fa61b0f446dedea"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#b23e8cbbe2df95cd59f0011baa5440b5">getResidualNorm</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return residual norm from the just-completed FAC iteration.  <a href="#b23e8cbbe2df95cd59f0011baa5440b5"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Implements the FAC iterative solution procedure for a linear system of equations, Au=f, defined on some subset of levels in an AMR patch hierarchy. 
<p>
The solution is found by applying an FAC algorithm to the composite grid represented in the hierarchy. After each FAC cycle the norm of the residual will be computed over all levels involved. The FAC iteration will stop when either the maximum number of iterations is reached, or the residual norm on all levels is below the given tolerance.<p>
The user must perform the following steps to use the FAC solver:<ol type=1>
<li>Create a <a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html">FACPreconditioner</a>, providing a valid concrete <a class="el" href="classSAMRAI_1_1solv_1_1FACOperatorStrategy.html">FACOperatorStrategy</a> object.</li><li>Set the stopping criteria using the setStoppingParameters() function.</li><li>Set the number of smooting sweeps using the setSmoothingSweeps() function. This is optional; if not used, the default is one sweep in each case.</li><li>Enable logging to record the FAC residual norms during the FAC itertion using the setFACLogFlag() function. This is optional; the default is to turn logging off. When loggin is turned on, the default mode is to send this information to the application log file (i.e., plog).</li><li>Invoke the FAC iteration process by calling <a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#c3109814e040e2133204a26d31ec2f0b">solveSystem()</a>, providing the vectors u and f, defined on a patch hierarchy containing the desired range of levels.</li><li>After solving, get solver statistics by viewing the log information and calling <a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#afebbb6567c56eaf44bbbbfccdcaa69d">getNumberOfIterations()</a>, <a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#b23e8cbbe2df95cd59f0011baa5440b5">getResidualNorm()</a> functions if desired. </li></ol>

<p>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="2e9c467686dbdb2e6d7aeed69b73aebe"></a><!-- doxytag: member="SAMRAI::solv::FACPreconditioner::FACPreconditioner" ref="2e9c467686dbdb2e6d7aeed69b73aebe" args="(const std::string &amp;name, FACOperatorStrategy &amp;user_ops, const boost::shared_ptr&lt; tbox::Database &gt; &amp;database=boost::shared_ptr&lt; tbox::Database &gt;())" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SAMRAI::solv::FACPreconditioner::FACPreconditioner           </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSAMRAI_1_1solv_1_1FACOperatorStrategy.html">FACOperatorStrategy</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>user_ops</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const boost::shared_ptr&lt; <a class="el" href="classSAMRAI_1_1tbox_1_1Database.html">tbox::Database</a> &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>database</em> = <code>boost::shared_ptr&lt;&nbsp;<a class="el" href="classSAMRAI_1_1tbox_1_1Database.html">tbox::Database</a>&nbsp;&gt;()</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Constructor.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>Object name </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>user_ops</em>&nbsp;</td><td>Reference to user-specified FAC operator </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>database</em>&nbsp;</td><td>Input database with initialization parameters </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="bf1bf0cc1ece3ad7ceacda43fd48e4c4"></a><!-- doxytag: member="SAMRAI::solv::FACPreconditioner::~FACPreconditioner" ref="bf1bf0cc1ece3ad7ceacda43fd48e4c4" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SAMRAI::solv::FACPreconditioner::~FACPreconditioner           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Virtual destructor. 
</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="c3109814e040e2133204a26d31ec2f0b"></a><!-- doxytag: member="SAMRAI::solv::FACPreconditioner::solveSystem" ref="c3109814e040e2133204a26d31ec2f0b" args="(SAMRAIVectorReal&lt; double &gt; &amp;solution, SAMRAIVectorReal&lt; double &gt; &amp;rhs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SAMRAI::solv::FACPreconditioner::solveSystem           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSAMRAI_1_1solv_1_1SAMRAIVectorReal.html">SAMRAIVectorReal</a>&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>solution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSAMRAI_1_1solv_1_1SAMRAIVectorReal.html">SAMRAIVectorReal</a>&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>rhs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Solve linear system Au=f using the FAC algorithm. 
<p>
The return value is true if the solver converged and false otherwise. The problem-specific portions of the FAC procedure, including the definitions of A are provided by the <a class="el" href="classSAMRAI_1_1solv_1_1FACOperatorStrategy.html">FACOperatorStrategy</a> object passed to the constructor. More information about the iteration can be found by calling the functions <a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#afebbb6567c56eaf44bbbbfccdcaa69d">getNumberOfIterations()</a> and <a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#b23e8cbbe2df95cd59f0011baa5440b5">getResidualNorm()</a> and by looking at the log information.<p>
Before calling this function, the form of the solution and right-hand-side quantities should be set properly by the user on all patch interiors on the range of levels covered by the FAC iteration. All data in these vectors (that will be used by the <a class="el" href="classSAMRAI_1_1solv_1_1FACOperatorStrategy.html">FACOperatorStrategy</a> implementation) should be allocated. Thus, the user is responsible for managing the storage for the solution and right-hand-side.<p>
Conditions on arguments:<ul>
<li>vectors solution and rhs must have same hierarchy</li><li>vectors solution and rhs must have same variables (except that solution can--and should--have enough ghost cells for computation).</li></ul>
<p>
Upon return from this function, the solution vector will contain the result of the solve.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>solution</em>&nbsp;</td><td>solution vector u </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rhs</em>&nbsp;</td><td>right hand side vector f</td></tr>
  </table>
</dl>
See <a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#224f2e5736891837a0a6f173ef2d5100">initializeSolverState()</a> and <a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#bf34a53392b560ef4450278071c2e5ef">deallocateSolverState()</a> for opportunities to save overhead when using multiple consecutive solves.<p>
<dl compact><dt><b>Returns:</b></dt><dd>whether solver converged to specified level</dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#224f2e5736891837a0a6f173ef2d5100">initializeSolverState</a> </dd></dl>

</div>
</div><p>
<a class="anchor" name="224f2e5736891837a0a6f173ef2d5100"></a><!-- doxytag: member="SAMRAI::solv::FACPreconditioner::initializeSolverState" ref="224f2e5736891837a0a6f173ef2d5100" args="(const SAMRAIVectorReal&lt; double &gt; &amp;solution, const SAMRAIVectorReal&lt; double &gt; &amp;rhs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SAMRAI::solv::FACPreconditioner::initializeSolverState           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classSAMRAI_1_1solv_1_1SAMRAIVectorReal.html">SAMRAIVectorReal</a>&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>solution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classSAMRAI_1_1solv_1_1SAMRAIVectorReal.html">SAMRAIVectorReal</a>&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>rhs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute hierarchy-dependent data required for solving. 
<p>
By default, the <a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#c3109814e040e2133204a26d31ec2f0b">solveSystem()</a> method computes some required hierarchy-dependent data before solving and removes that data after the solve. For multiple solves using the same hierarchy configuration, it is more efficient to manually compute, using <a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#224f2e5736891837a0a6f173ef2d5100">initializeSolverState()</a>, and remove, using <a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#bf34a53392b560ef4450278071c2e5ef">deallocateSolverState()</a>, the hierarchy-dependent data so that it is not done inside <a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#c3109814e040e2133204a26d31ec2f0b">solveSystem()</a>. If <a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#c3109814e040e2133204a26d31ec2f0b">solveSystem()</a> detects that the solver state is already initialized, it will <em>NOT</em> change the state.<p>
The vector arguments for <a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#c3109814e040e2133204a26d31ec2f0b">solveSystem()</a> need not match those for <a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#224f2e5736891837a0a6f173ef2d5100">initializeSolverState()</a>. However, there must be a certain degree of similarity, including<ul>
<li>hierarchy configuration (hierarchy pointer and level range)</li><li>number, type and alignment of vector component data</li><li>ghost cell width of data in the solution vector</li></ul>
<p>
When assertion checking is enabled, limited checking is done by <a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#c3109814e040e2133204a26d31ec2f0b">solveSystem()</a> to help ensure that of the vectors passed to <a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#c3109814e040e2133204a26d31ec2f0b">solveSystem()</a> is compatible with the existing state.<p>
It is important to remember to reinitialize the solver state when your hierarchy configuration changes.<p>
It is safe to <a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#224f2e5736891837a0a6f173ef2d5100">initializeSolverState()</a> when the state is already initialized (the state is deallocated and reinitialized).<p>
Conditions on arguments:<ul>
<li>solution and rhs must have same hierarchy</li><li>solution and rhs must have same structure, depth, etc. (except that u can--and should--have enough ghost cells for computation).</li><li>coarsest_ln through finest_ln must exist in u.</li></ul>
<p>
To unset the data set in this function, see <a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#bf34a53392b560ef4450278071c2e5ef">deallocateSolverState()</a>.<p>
After setting data for the current object, this function calls the operator's corresponding function, <a class="el" href="classSAMRAI_1_1solv_1_1FACOperatorStrategy.html#2fb54d806fdf60549bcaada57a3694a7">FACOperatorStrategy::initializeOperatorState()</a> so that the operator object can take steps to remain in sync.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>solution</em>&nbsp;</td><td>solution vector u </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rhs</em>&nbsp;</td><td>right hand side vector f </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="bf34a53392b560ef4450278071c2e5ef"></a><!-- doxytag: member="SAMRAI::solv::FACPreconditioner::deallocateSolverState" ref="bf34a53392b560ef4450278071c2e5ef" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SAMRAI::solv::FACPreconditioner::deallocateSolverState           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Remove all hierarchy-dependent data computed by <a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#224f2e5736891837a0a6f173ef2d5100">initializeSolverState()</a>. 
<p>
Remove all hierarchy-dependent data set by <a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#224f2e5736891837a0a6f173ef2d5100">initializeSolverState()</a>. It is safe to call <a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#bf34a53392b560ef4450278071c2e5ef">deallocateSolverState()</a> even state is already deallocated.<p>
After deallocating data for the current object, this function calls the operator's corresponding function, <a class="el" href="classSAMRAI_1_1solv_1_1FACOperatorStrategy.html#cd3290e2ac8e3f53342c4997afcc0c43">FACOperatorStrategy::deallocateOperatorState()</a> so that the operator object can take steps to remain in sync.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#224f2e5736891837a0a6f173ef2d5100">initializeSolverState</a> </dd></dl>

</div>
</div><p>
<a class="anchor" name="c93151dec50bdf46302096909c86ac8f"></a><!-- doxytag: member="SAMRAI::solv::FACPreconditioner::checkVectorStateCompatibility" ref="c93151dec50bdf46302096909c86ac8f" args="(const SAMRAIVectorReal&lt; double &gt; &amp;solution, const SAMRAIVectorReal&lt; double &gt; &amp;rhs) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SAMRAI::solv::FACPreconditioner::checkVectorStateCompatibility           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classSAMRAI_1_1solv_1_1SAMRAIVectorReal.html">SAMRAIVectorReal</a>&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>solution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classSAMRAI_1_1solv_1_1SAMRAIVectorReal.html">SAMRAIVectorReal</a>&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>rhs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Check compatibility of vectors with existing solver state. 
<p>
Check whether the solution and residual vectors given are compatible with the existing solver state (solver state must be initialized). Compatibility means that the vectors are sufficiently similar with the vectors with which the state are initialized. Compatibility implies that the vectors may be used in <a class="el" href="classSAMRAI_1_1solv_1_1FACPreconditioner.html#c3109814e040e2133204a26d31ec2f0b">solveSystem()</a>.<p>
The checking is not perfect! Due to the possibility of user-defined patch data, data-dependent checks cannot be performed. It is possible that a false compatibility is returned.<p>
<dl compact><dt><b>Returns:</b></dt><dd>true if vectors are compatible with existing state </dd></dl>

</div>
</div><p>
<a class="anchor" name="106b064c71994802f3a5cdc3ccc4afc7"></a><!-- doxytag: member="SAMRAI::solv::FACPreconditioner::setPresmoothingSweeps" ref="106b064c71994802f3a5cdc3ccc4afc7" args="(int num_pre_sweeps)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SAMRAI::solv::FACPreconditioner::setPresmoothingSweeps           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>num_pre_sweeps</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set the number of pre-smoothing sweeps during FAC iteration process. 
<p>
Presmoothing is applied during the fine-to-coarse phase of the iteration. The default is to use one sweep.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>num_pre_sweeps</em>&nbsp;</td><td>Number of presmoothing sweeps </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="56931d46e0b47521deeac16bd94d8f2c"></a><!-- doxytag: member="SAMRAI::solv::FACPreconditioner::setPostsmoothingSweeps" ref="56931d46e0b47521deeac16bd94d8f2c" args="(int num_post_sweeps)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SAMRAI::solv::FACPreconditioner::setPostsmoothingSweeps           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>num_post_sweeps</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set the number of post-smoothing sweeps during FAC iteration process. 
<p>
Postsmoothing is applied during the coarse-to-fine phase of the iteration. The default is to use one sweep.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>num_post_sweeps</em>&nbsp;</td><td>Number of postsmoothing sweeps </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="fe186c64f642b4250e38cf525d7e4ffa"></a><!-- doxytag: member="SAMRAI::solv::FACPreconditioner::setMaxCycles" ref="fe186c64f642b4250e38cf525d7e4ffa" args="(int max_cycles)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SAMRAI::solv::FACPreconditioner::setMaxCycles           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>max_cycles</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set the max number of iterations (cycles) to use per solve. 
<p>

</div>
</div><p>
<a class="anchor" name="bc8ee965b915317f32f1c623441814e4"></a><!-- doxytag: member="SAMRAI::solv::FACPreconditioner::setResidualTolerance" ref="bc8ee965b915317f32f1c623441814e4" args="(double residual_tol, double relative_residual_tol=-1.0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SAMRAI::solv::FACPreconditioner::setResidualTolerance           </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>residual_tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>relative_residual_tol</em> = <code>-1.0</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set the residual tolerance for stopping. 
<p>
The solution is considered converged if ||b-Ax|| &lt;= residual_tol <b>or</b> ||b-Ax|| &lt;= relative_residual_tol*||b||.<p>
If you want the prescribed maximum number of cycles to always be taken, set both residual tolerances to negative numbers. 
</div>
</div><p>
<a class="anchor" name="a08148017b68708b80720938132685f9"></a><!-- doxytag: member="SAMRAI::solv::FACPreconditioner::setAlgorithmChoice" ref="a08148017b68708b80720938132685f9" args="(const std::string &amp;choice)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SAMRAI::solv::FACPreconditioner::setAlgorithmChoice           </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>choice</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set the choice of FAC cycling algorithm to use. 
<p>
For developer experimentation use only. All others should use the default choice. 
</div>
</div><p>
<a class="anchor" name="4c89ecf5208e7b610667034fcc52161d"></a><!-- doxytag: member="SAMRAI::solv::FACPreconditioner::enableLogging" ref="4c89ecf5208e7b610667034fcc52161d" args="(bool enabled=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SAMRAI::solv::FACPreconditioner::enableLogging           </td>
          <td>(</td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>enabled</em> = <code>true</code>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Enable or disable logging. 
<p>
Set streams to NULL to turn off output.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>enabled</em>&nbsp;</td><td>Logging state. true=on, false=off. </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="afebbb6567c56eaf44bbbbfccdcaa69d"></a><!-- doxytag: member="SAMRAI::solv::FACPreconditioner::getNumberOfIterations" ref="afebbb6567c56eaf44bbbbfccdcaa69d" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SAMRAI::solv::FACPreconditioner::getNumberOfIterations           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return FAC iteration count from last (or current if there is one) FAC iteration process. 
<p>

</div>
</div><p>
<a class="anchor" name="920b3306fa08ad13648e4b489d8b375f"></a><!-- doxytag: member="SAMRAI::solv::FACPreconditioner::getConvergenceFactors" ref="920b3306fa08ad13648e4b489d8b375f" args="(double &amp;avg_factor, double &amp;final_factor) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SAMRAI::solv::FACPreconditioner::getConvergenceFactors           </td>
          <td>(</td>
          <td class="paramtype">double &amp;&nbsp;</td>
          <td class="paramname"> <em>avg_factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&nbsp;</td>
          <td class="paramname"> <em>final_factor</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get convergance rates of the last (or current if there is one) FAC solve. 
<p>
The convergence factor is the factor to which the residual has been reduced. The final factor is that from the last FAC cycle.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>avg_factor</em>&nbsp;</td><td>average convergence factor over FAC cycles from last solve. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>final_factor</em>&nbsp;</td><td>convergence factor of the last FAC cycle </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="237802e2e0047b4a946bd218a1525875"></a><!-- doxytag: member="SAMRAI::solv::FACPreconditioner::getNetConvergenceFactor" ref="237802e2e0047b4a946bd218a1525875" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double SAMRAI::solv::FACPreconditioner::getNetConvergenceFactor           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get the net convergance rate of the last (or current if there is one) FAC solve. 
<p>
The net factor is the factor to which the residual has been reduced by the FAC cycles. It is (current residual)/( initial residual + epsilon), so it may not be accurate if the initial residual is very small. 
</div>
</div><p>
<a class="anchor" name="38798adf3e0362d69ec57a7f8c2ef908"></a><!-- doxytag: member="SAMRAI::solv::FACPreconditioner::getAvgConvergenceFactor" ref="38798adf3e0362d69ec57a7f8c2ef908" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double SAMRAI::solv::FACPreconditioner::getAvgConvergenceFactor           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get the average convergance rates of the last (or current if there is one) FAC solve. 
<p>
The average factor is the net factor to the power of 1/(number of FAC cycles). It may not be accurate if the initial residual is very small. 
</div>
</div><p>
<a class="anchor" name="ab425776ab17c5a75fa61b0f446dedea"></a><!-- doxytag: member="SAMRAI::solv::FACPreconditioner::getFinalConvergenceFactor" ref="ab425776ab17c5a75fa61b0f446dedea" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double SAMRAI::solv::FACPreconditioner::getFinalConvergenceFactor           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get the final convergance rate of the last (or current if there is one) FAC solve. 
<p>
The final factor is the factor to which the residual has been reduced by the last FAC cycle. 
</div>
</div><p>
<a class="anchor" name="b23e8cbbe2df95cd59f0011baa5440b5"></a><!-- doxytag: member="SAMRAI::solv::FACPreconditioner::getResidualNorm" ref="b23e8cbbe2df95cd59f0011baa5440b5" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double SAMRAI::solv::FACPreconditioner::getResidualNorm           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return residual norm from the just-completed FAC iteration. 
<p>
The norm return value is computed as the maximum norm over all patch levels involved in the solve. The value corresponds to the norm applied in the user-defined residual computation.<p>
The latest computed norm is the one returned. 
</div>
</div><p>
<a class="anchor" name="742507f38d5d6f62cd41aa185123f248"></a><!-- doxytag: member="SAMRAI::solv::FACPreconditioner::printClassData" ref="742507f38d5d6f62cd41aa185123f248" args="(std::ostream &amp;os) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SAMRAI::solv::FACPreconditioner::printClassData           </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&nbsp;</td>
          <td class="paramname"> <em>os</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Print data members for debugging. 
<p>

</div>
</div><p>
<a class="anchor" name="66f2514781a4e19a2722bc454b9aecd3"></a><!-- doxytag: member="SAMRAI::solv::FACPreconditioner::getObjectName" ref="66f2514781a4e19a2722bc454b9aecd3" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const std::string&amp; SAMRAI::solv::FACPreconditioner::getObjectName           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get the name of this object. 
<p>
<dl compact><dt><b>Returns:</b></dt><dd>The name of this object. </dd></dl>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li>source/SAMRAI/solv/<a class="el" href="FACPreconditioner_8h.html">FACPreconditioner.h</a><li>source/SAMRAI/solv/<a class="el" href="FACPreconditioner_8C.html">FACPreconditioner.C</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Thu Jun 21 13:42:58 2012 for SAMRAI by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
